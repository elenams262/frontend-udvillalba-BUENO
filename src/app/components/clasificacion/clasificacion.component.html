<div class="container">
  <div class="header-section">
    <h2>Clasificaci√≥n</h2>

    @if (esAdmin) {
    <button class="btn btn-warning" (click)="toggleEdicion()">
      ‚öôÔ∏è {{ modoEdicion ? 'Finalizar Edici√≥n' : 'Editar Clasificaci√≥n' }}
    </button>
    }
  </div>

  <div class="table-responsive">
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Pos</th>
          <th>Equipo</th>
          <th>PTS</th>
          <th>PJ</th>
          <th>PG</th>
          <th>PE</th>
          <th>PP</th>
          <th>GF</th>
          <th>GC</th>
          <th>Forma</th>
          @if (modoEdicion) {
          <th>Acciones</th>
          }
        </tr>
      </thead>
      <tbody>
        @for (equipo of clasificacion; track equipo._id) {
        <tr [class]="getClassForPosition(equipo.posicion)">
          <td class="posicion">{{ equipo.posicion }}</td>

          <td class="equipo-col">
            @if (equipo.escudo) {
            <img [src]="api.URL_IMAGENES + equipo.escudo" alt="Escudo" class="escudo-img" />
            }

            <span class="nombre-equipo">{{ equipo.nombre }}</span>

            @if (modoEdicion) {
            <input
              type="text"
              [(ngModel)]="equipo.escudo"
              placeholder="Ej: Colmenarejo.png"
              class="form-control form-control-sm"
              style="width: 150px; margin-top: 5px; display: block"
            />
            }
          </td>
          <td class="fw-bold">{{ equipo.puntos }}</td>

          <td>
            @if (modoEdicion) {
            <input
              type="number"
              [(ngModel)]="equipo.partidosJugados"
              class="form-control form-control-sm input-corto"
            />
            } @else {
            {{ equipo.partidosJugados }}
            }
          </td>

          <td>
            @if (modoEdicion) {
            <input
              type="number"
              [(ngModel)]="equipo.partidosGanados"
              class="form-control form-control-sm input-corto"
            />
            } @else {
            {{ equipo.partidosGanados }}
            }
          </td>

          <td>
            @if (modoEdicion) {
            <input
              type="number"
              [(ngModel)]="equipo.partidosEmpatados"
              class="form-control form-control-sm input-corto"
            />
            } @else {
            {{ equipo.partidosEmpatados }}
            }
          </td>

          <td>
            @if (modoEdicion) {
            <input
              type="number"
              [(ngModel)]="equipo.partidosPerdidos"
              class="form-control form-control-sm input-corto"
            />
            } @else {
            {{ equipo.partidosPerdidos }}
            }
          </td>

          <td>
            @if (modoEdicion) {
            <input
              type="number"
              [(ngModel)]="equipo.golesFavor"
              class="form-control form-control-sm input-corto"
            />
            } @else {
            {{ equipo.golesFavor }}
            }
          </td>

          <td>
            @if (modoEdicion) {
            <input
              type="number"
              [(ngModel)]="equipo.golesContra"
              class="form-control form-control-sm input-corto"
            />
            } @else {
            {{ equipo.golesContra }}
            }
          </td>

          <td>
            <div class="forma-container">
              @for (resultado of equipo.forma; track $index) {
              <span class="badge" [ngClass]="getFormaClass(resultado)">{{ resultado }}</span>
              }
            </div>
          </td>

          @if (modoEdicion) {
          <td>
            <button class="btn btn-sm btn-success" (click)="guardarCambios(equipo)">üíæ</button>
          </td>
          }
        </tr>
        } @if (modoEdicion) {
        <tr class="fila-creacion" style="background-color: #e8f8f5; border-top: 2px solid #2ecc71">
          <td><span class="badge bg-success">+</span></td>

          <td>
            <input
              type="text"
              [(ngModel)]="nuevoEquipo.nombre"
              placeholder="Nombre Equipo"
              class="form-control form-control-sm"
              style="min-width: 150px; margin-bottom: 5px"
            />
            <input
              type="text"
              [(ngModel)]="nuevoEquipo.escudo"
              placeholder="Ej: NuevoBoadilla.png"
              class="form-control form-control-sm"
              style="min-width: 150px"
            />
          </td>

          <td>
            <input
              type="number"
              [(ngModel)]="nuevoEquipo.puntos"
              class="form-control form-control-sm input-corto"
              placeholder="PTS"
            />
          </td>
          <td>
            <input
              type="number"
              [(ngModel)]="nuevoEquipo.partidosJugados"
              class="form-control form-control-sm input-corto"
              placeholder="PJ"
            />
          </td>
          <td>
            <input
              type="number"
              [(ngModel)]="nuevoEquipo.partidosGanados"
              class="form-control form-control-sm input-corto"
              placeholder="PG"
            />
          </td>
          <td>
            <input
              type="number"
              [(ngModel)]="nuevoEquipo.partidosEmpatados"
              class="form-control form-control-sm input-corto"
              placeholder="PE"
            />
          </td>
          <td>
            <input
              type="number"
              [(ngModel)]="nuevoEquipo.partidosPerdidos"
              class="form-control form-control-sm input-corto"
              placeholder="PP"
            />
          </td>
          <td>
            <input
              type="number"
              [(ngModel)]="nuevoEquipo.golesFavor"
              class="form-control form-control-sm input-corto"
              placeholder="GF"
            />
          </td>
          <td>
            <input
              type="number"
              [(ngModel)]="nuevoEquipo.golesContra"
              class="form-control form-control-sm input-corto"
              placeholder="GC"
            />
          </td>
          <td>-</td>
          <td>
            <button class="btn btn-sm btn-primary" (click)="crearEquipo()">‚ûï</button>
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
</div>
